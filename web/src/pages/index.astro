---
import GlobalLayout from '../layouts/GlobalLayout/GlobalLayout.astro';
import {apiClient} from "../lib/api/api-client";
import Greeter from "../components/Greeter/Greeter.astro";
import CardListing from "../components/CardListing/CardListing.astro";

const homepage = await apiClient.getHomepage()
const featuredProjects = await apiClient.getFeaturedProjects()
const featuredBlogPosts = await apiClient.getFeaturedBlogPosts()
---

<GlobalLayout title="Home">
	<Greeter
		contentHtml={homepage.greeterContentHtml}
		socialLinks={homepage.socialLinks}
	/>

	<CardListing
		title="Projects"
		viewAllText="All Projects"
		viewAllLink="/projects"
		cards={featuredProjects.map(project => {
			return {
				title: project.name,
				description: project.description,
				link: `/projects/${project.slug}`
			}
		})}
	/>

	<CardListing
		title="Blog Posts"
		viewAllText="All Blog Posts"
		viewAllLink="/blog"
		cards={featuredBlogPosts.map(blogPost => {
			return {
				title: blogPost.title,
				description: blogPost.description,
				link: `/blog/${blogPost.slug}`
			}
		})}
	/>

</GlobalLayout>
