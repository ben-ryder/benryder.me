---
import {JBadge} from "@ben-ryder/jigsaw-react";

import {apiClient} from "@lib/api/api-client";
import GlobalLayout from "../../layouts/GlobalLayout/GlobalLayout.astro";
import CardListing from "../../components/CardListing/CardListing.astro";

const projects = await apiClient.getProjects()
const projectTags = await apiClient.getProjectTags()
---

<GlobalLayout title="Projects">
	<div>
		<ul>
			{projectTags.map(tag =>
				<li>
					<JBadge
						text={tag.text}
						variant={tag.colour}
						href={`/projects?tags=${tag.slug}`}
					/>
				</li>
			)}
		</ul>
	</div>

	<CardListing
		title="My Projects"
		cards={projects.map(project => {
			return {
				title: project.name,
				description: project.description,
				link: `/projects/${project.slug}`
			}
		})}
	/>
</GlobalLayout>
