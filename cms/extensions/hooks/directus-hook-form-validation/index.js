const e=((e,t,r=500)=>class extends Error{name="DirectusError";extensions;code=e.toUpperCase();status=r;constructor(e,r){super("string"==typeof t?t:t(e),r),this.extensions=e}toString(){return`${this.name} [${this.code}]: ${this.message}`}})("INVALID_REQUEST_ERROR","The request appears invalid or not genuine.",400);var t=({filter:t},{env:r,exceptions:n})=>{t("form_contact.items.create",(async t=>{if(t.honeypot)throw new e;if(!t.captcha)throw new e;const n=r.CAPTCHA_SECRET,s=r.CAPTCHA_VERIFICATION_URL;if(!s||!n)throw new e;if(!await async function(e,t){try{return(await fetch(e.url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({secret:e.secret,response:t}).toString()})).ok}catch(e){return!1}}({url:s,secret:n},t.captcha))throw new e;return t}))};export{t as default};
